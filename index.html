<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="Stylesheet" href="style.css">
    <link rel="shortcut icon" href="glowa.png">
    <title>Świąteczny Wonszszsz</title>
</head>
<body>
    <script>
        let speed = 100;
        let beginningPositionOfSnake = 5;

        let nav = document.createElement("nav");
        document.body.appendChild(nav);
        nav.innerText = "Wesołych Świąt!!!"

        let main = document.createElement("div");
        main.id = "main";
        document.body.appendChild(main);

        let changingSpeed = function(temp)
        {
            speed = temp;
        }

        let buttons = function(button,text,buttonId,speedValue)
        {
            button.id = buttonId;
            main.appendChild(button);
            button.innerHTML = text;

            button.onclick = function()
            {
                setTimeout(changingSpeed(speedValue),1000);
                console.log(button);
            }
        }
        let bt1 = document.createElement("button");
        let bt2 = document.createElement("button");
        let bt3 = document.createElement("button");
        buttons(bt1, "Łatwy", "bt1",500);
        buttons(bt2,"Średni", "bt2",300);
        buttons(bt3,"Trudny", "bt3",100);

        let board = document.createElement("div");
        board.id = "board";
        main.appendChild(board);

        let horizontalNumberOfPoints = 20;
        let verticalNumberOfPoints = 20;
        let widthOfPoint = 30;
        let heightOfPoint = 30;

        for(let i = 0; i < horizontalNumberOfPoints; i++)
        {
            for(let j = 0; j < verticalNumberOfPoints; j++)
            {
                let pointsOnBoard = document.createElement("div");
                pointsOnBoard.className = "pointsOnBoard";
                pointsOnBoard.style.left = i * widthOfPoint + 'px';
                pointsOnBoard.style.top = j * heightOfPoint + 'px';
                board.appendChild(pointsOnBoard);

                board.style.width = i * widthOfPoint + "px";

                if( i == 0 || j == 0 || i == horizontalNumberOfPoints - 1 || j == verticalNumberOfPoints - 1)
                {
                    pointsOnBoard.style.backgroundImage = "url('choinkaa.png')";
                }
            }
        }
        let point = 0;
        let tableOfPoints = document.createElement("div");
        tableOfPoints.id = "tableOfPoints";
        main.appendChild(tableOfPoints);
        tableOfPoints.innerText = "Twoje punkty \n" + point;

        let snake = document.createElement("div");
        snake.id = "0";
        snake.className = "snake"
        board.appendChild(snake);
        snake.style.left = widthOfPoint * beginningPositionOfSnake + "px";
        snake.style.top = heightOfPoint * beginningPositionOfSnake + "px";

        let tailLength = 0

        let growingSnake = function()
        {
            let tail = document.createElement("div");
            tail.className = "tail";
            tail.id = tailLength + 1;
            tail.style.width = "0px";
            board.appendChild(tail);
            tailLength++
        }

        let right = false;
        let left = false;
        let up = false;
        let down = false;

        let horizontalPositionOf0 = document.getElementById("0").style.left.slice(0,document.getElementById("0").style.left.length-2)/widthOfPoint;
        let verticalPositionOf0 = document.getElementById("0").style.top.slice(0,document.getElementById("0").style.top.length-2)/widthOfPoint; 

        let headLeft = [];
        let headTop = [];

        let RightMoving0 = function()
        {
            let rightt = setInterval(function()
            {
                if(right == true)
                {
                    document.getElementById(tailLength).style.width = "25px";
                    for(let i = 0; i < tailLength + 1; i++)
                    {
                        headLeft[i] = document.getElementById(i).style.left;
                        headTop[i] = document.getElementById(i).style.top;
                    }

                    if(horizontalPositionOf0 < horizontalNumberOfPoints - 2)
                    {  
                        horizontalPositionOf0++
                        snake.style.left = widthOfPoint * (horizontalPositionOf0) + "px"
                        for(let i = 0; i < tailLength; i++)
                        {
                            document.getElementById(i+1).style.left = headLeft[i];
                            document.getElementById(i+1).style.top = headTop[i];
                        }
                        gettingPoint();
                    }
                    else
                    {
                        loseFuntion();
                        right = false;
                    }
                }
                else{ clearInterval(rightt) }
            },speed)
        }

        let LeftMoving0 = function()
        {
        let leftt = setInterval(function()
        {
            if(left == true)
            {
                document.getElementById(tailLength).style.width = "25px";
                for(let i = 0; i < tailLength + 1; i++)
                {
                    headLeft[i] = document.getElementById(i).style.left;
                    headTop[i] = document.getElementById(i).style.top;
                }
                if(horizontalPositionOf0 > 1)
                {  
                    horizontalPositionOf0--
                    snake.style.left = widthOfPoint * horizontalPositionOf0 + "px"
                    for(let i = 0; i < tailLength; i++)
                    {
                        document.getElementById(i+1).style.left = headLeft[i];
                        document.getElementById(i+1).style.top = headTop[i];
                    }
                    gettingPoint();
                }
                else
                {
                    loseFuntion();
                    left = false;
                }
            } 
            else{clearInterval(leftt)}
        },speed)
        }

        let UpMoving0 = function()
        {
        let upp = setInterval(function()
        {
            if(up == true)
            {
                document.getElementById(tailLength).style.width = "25px";
                for(let i = 0; i < tailLength + 1; i++)
                {
                    headLeft[i] = document.getElementById(i).style.left;
                    headTop[i] = document.getElementById(i).style.top;
                }

                if(verticalPositionOf0 > 1)
                {  
                    verticalPositionOf0--
                    snake.style.top = heightOfPoint * verticalPositionOf0 + "px"
                    for(let i = 0; i < tailLength; i++)
                    {
                        document.getElementById(i+1).style.left = headLeft[i];
                        document.getElementById(i+1).style.top = headTop[i];
                    }
                    gettingPoint();
                }
                else
                {
                    loseFuntion();
                    up = false;
                }
            }
            else{(clearInterval(upp))}
        },speed)
        }

        let DownMoving0 = function()
        {
        let downn = setInterval(function()
        {
            if(down == true)
            {
                document.getElementById(tailLength).style.width = "25px";
                for(let i = 0; i < tailLength + 1; i++)
                {
                    headLeft[i] = document.getElementById(i).style.left;
                    headTop[i] = document.getElementById(i).style.top;
                }
                if(verticalPositionOf0 < verticalNumberOfPoints - 2)
                {  
                    verticalPositionOf0++
                    snake.style.top = heightOfPoint * verticalPositionOf0 + "px"
                    for(let i = 0; i < tailLength; i++)
                    {
                        document.getElementById(i+1).style.left = headLeft[i];
                        document.getElementById(i+1).style.top = headTop[i];
                    }
                    gettingPoint();
                }
                else
                {
                    loseFuntion();
                    down = false;
                }
            }
            else{clearInterval(downn)}
        },speed)
        }
        
        document.onkeydown = function(event) 
        {
            switch(event.keyCode)
            {
                case 37: 
                    right = false;
                    left = true;
                    up = false;
                    down = false;
                    LeftMoving0();
                    break; 

                case 38:
                    right = false;
                    left = false;
                    up = true;
                    down = false;
                    UpMoving0();
                    break;

                case 39:
                    right = true;
                    left = false;
                    up = false;
                    down = false;
                    RightMoving0();
                    break;

                case 40:
                    right = false;
                    left = false;
                    up = false;
                    down = true;
                    DownMoving0();
                    break;
            }   
        }
            let price = document.createElement("div");
            price.id = "price";

        let priceFunction = function()
        {
            board.appendChild(price);
            let randomLeftPrice = Math.floor((Math.random() * (horizontalNumberOfPoints-3)) + 2);
            let leftPositionOfPrice = randomLeftPrice * widthOfPoint + "px";
            let randomTopPrice = Math.floor((Math.random() * (verticalNumberOfPoints-3)) + 2);
            let topPositionOfPrice = randomTopPrice * heightOfPoint + "px";

            price.style.left = leftPositionOfPrice;
            price.style.top = topPositionOfPrice;
        }
        priceFunction();

        let loseFuntion = function()
        {
            document.getElementById("0").style.left = widthOfPoint * 5 + "px";
            document.getElementById("0").style.top = heightOfPoint * 5 + "px";
            alert("Przegrałeś :(")
            horizontalPositionOf0 = document.getElementById("0").style.left.slice(0,document.getElementById("0").style.left.length-2)/widthOfPoint;
            verticalPositionOf0 = document.getElementById("0").style.top.slice(0,document.getElementById("0").style.top.length-2)/widthOfPoint; 
            point = 0;
            tableOfPoints.innerText = "Twoje punkty \n" + point;
            clearInterval(loseFuntion)
            for(let i = 1; i <= tailLength; i++)
            {
                board.removeChild(document.getElementById(i))
            }
            tailLength = 0;
        }
        let gettingPoint = function()
        {
            if(document.getElementById("price").style.left == document.getElementById("0").style.left && document.getElementById("price").style.top == document.getElementById("0").style.top)
            {
                point++
                tableOfPoints.innerText = "Twoje punkty \n" + point;
                growingSnake();
                priceFunction();
            }
        }
    </script>
</body>
</html>